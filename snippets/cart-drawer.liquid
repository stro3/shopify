{%- comment -%}
  Snippet: cart-drawer.liquid
  Renders the full cart drawer overlay + panel.
  Logic handled by cart.js (CartDrawer class).
{%- endcomment -%}

<!-- Overlay -->
<div id="CartDrawerOverlay" class="cart-drawer-overlay" aria-hidden="true"></div>

<!-- Drawer panel -->
<div
  id="CartDrawer"
  class="cart-drawer"
  role="dialog"
  aria-modal="true"
  aria-label="Shopping Cart"
  tabindex="-1"
>

  <!-- Header -->
  <div class="cart-drawer__header">
    <h2 class="cart-drawer__title">
      Your Cart
      <span style="font-weight:400;font-size:1.5rem;color:rgba(var(--color-base-text),.5);">
        (<span data-cart-count>{{ cart.item_count }}</span>)
      </span>
    </h2>
    <button class="cart-drawer__close" aria-label="Close cart">
      <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
        <line x1="18" y1="6" x2="6" y2="18"/><line x1="6" y1="6" x2="18" y2="18"/>
      </svg>
    </button>
  </div>

  <!-- Items (rendered/refreshed by JS) -->
  <div class="cart-drawer__items" aria-live="polite" aria-atomic="true">
    {%- if cart.item_count == 0 -%}
      <div class="cart-drawer__empty">
        <svg width="64" height="64" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5">
          <circle cx="9" cy="21" r="1"/><circle cx="20" cy="21" r="1"/>
          <path d="M1 1h4l2.68 13.39a2 2 0 0 0 2 1.61h9.72a2 2 0 0 0 2-1.61L23 6H6"/>
        </svg>
        <p>Your cart is empty</p>
        <a href="/collections/all" class="btn btn--primary" style="margin-top:1.6rem;">Continue Shopping</a>
      </div>
    {%- else -%}
      {%- for item in cart.items -%}
        <div class="cart-item">
          <div class="cart-item__image">
            {%- if item.image -%}
              <img
                src="{{ item.image | image_url: width: 160 }}"
                alt="{{ item.title | escape }}"
                loading="lazy"
                width="80" height="80"
              >
            {%- endif -%}
          </div>
          <div class="cart-item__details">
            <div class="cart-item__title">{{ item.product_title }}</div>
            {%- if item.variant_title and item.variant_title != 'Default Title' -%}
              <div class="cart-item__variant">{{ item.variant_title }}</div>
            {%- endif -%}
            {%- if item.properties.size > 0 -%}
              {%- for p in item.properties -%}
                {%- unless p.first contains '_' -%}
                  <div class="cart-item__variant">{{ p.first }}: {{ p.last }}</div>
                {%- endunless -%}
              {%- endfor -%}
            {%- endif -%}
            <div class="cart-item__bottom">
              <div class="cart-item__qty">
                <button data-cart-item-decrease="{{ item.key }}" aria-label="Decrease quantity">âˆ’</button>
                <span>{{ item.quantity }}</span>
                <button data-cart-item-increase="{{ item.key }}" aria-label="Increase quantity">+</button>
              </div>
              <div class="cart-item__price">{{ item.final_line_price | money }}</div>
            </div>
            <button class="cart-item__remove" data-cart-item-remove="{{ item.key }}">Remove</button>
          </div>
        </div>
      {%- endfor -%}
    {%- endif -%}
  </div>

  <!-- Footer -->
  <div class="cart-drawer__footer">
    <div class="cart-drawer__subtotal">
      <span>Subtotal</span>
      <span class="cart-drawer__subtotal-price" data-cart-subtotal>{{ cart.total_price | money }}</span>
    </div>
    <p class="cart-drawer__note">Shipping and taxes calculated at checkout</p>
    <a
      href="{{ routes.checkout_url }}"
      class="btn btn--primary btn--full"
      data-cart-checkout
      {% if cart.item_count == 0 %}disabled{% endif %}
      aria-label="Proceed to checkout"
    >
      Checkout
    </a>
    <a href="/cart" class="btn btn--secondary btn--full" style="margin-top:.8rem;">View Cart</a>
  </div>

</div>
